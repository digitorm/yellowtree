(async()=>{var t=await import(window.theme.modules.baseComponent);customElements.define("cart-item",class extends t.default{elements={plusButton:"[data-inc]",minusButton:"[data-dec]",removeButton:"[data-remove]",qtyInput:"[data-input]",linePrice:"[data-total]"};render(){this.sectionId=this.getAttribute("section-id"),this.lineIndex=this.getAttribute("line-item-index"),this.variantId=this.getAttribute("cart-item-variant-id"),this.qtyValue=+this.$qtyInput.value,this.variantQtyLimit=+this.$qtyInput.max,this._handleInteractions()}_handleInteractions(){this.$plusButton.addEventListener("click",()=>this._validateInput(1)),this.$minusButton.addEventListener("click",()=>this._validateInput(-1)),this.$qtyInput.addEventListener("change",()=>this._validateInput()),this.$removeButton.addEventListener("click",this._removeItem.bind(this))}_validateInput(t){t=t?this.qtyValue+t:+this.$qtyInput.value;t<1||t>this.variantQtyLimit?this.$qtyInput.value=this.qtyValue:(this.qtyValue=t,this._updateUI(),this._updateCartRequest(t))}_removeItem(t){t.preventDefault(),this._updateCartRequest(0)}_updateUI(){this._updateInputValue(),this._updateButtons()}_updateInputValue(){this.$qtyInput.value=this.qtyValue}_updateButtons(){this.$plusButton.disabled=this.qtyValue===this.variantQtyLimit,this.$minusButton.disabled=1===this.qtyValue}_updateCartRequest(e){var t=JSON.stringify({id:this.variantId,quantity:e,sections:this.sectionId,sections_url:window.location.pathname});fetch(`${routes.cart_change_url}`,{...{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}},body:t}).then(t=>t.json()).then(t=>{t=t.sections[this.sectionId],t=(new DOMParser).parseFromString(t,"text/html");this._acceptChanges(t,e)}).catch(t=>{console.error(t)})}_acceptChanges(t,e){this.forwardEvent("cartChange",{html:t,remove:0===e}),0!==e?this._updateLinePrice(t):this.remove()}_updateLinePrice(t){t=t.querySelector(`[data-total="${this.variantId}"]`);this.$linePrice.replaceChildren(...t.childNodes)}})})();